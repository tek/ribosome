name: ribosome-test
synopsis: High Level Neovim Plugin Framework, Tests
<<: !include shared/meta.yaml
defaults:
  local: shared/defaults.yaml

library:
  source-dirs: lib
  generated-other-modules:
    Paths_ribosome_test
  dependencies:
    - name: ribosome
      mixin:
        - hiding (Ribosome.Prelude)
        - (Ribosome.Prelude as Prelude)
    - bytestring
    - chiasma
    - containers
    - cornea
    - directory
    - either
    - exceptions
    - filepath
    - free
    - hedgehog
    - hslogger
    - lifted-async
    - lifted-base
    - messagepack
    - monad-control
    - mtl
    - nvim-hs
    - process
    - relude >= 0.7
    - resourcet
    - tasty
    - tasty-hedgehog
    - text
    - transformers
    - typed-process
    - unix
    - unliftio

extra-source-files:
  - readme.md

tests:
  ribosome-unit:
    main: Main.hs
    source-dirs: test
    ghc-options:
      - -threaded
      - -rtsopts
      - -with-rtsopts=-N
    dependencies:
      - name: ribosome
        mixin:
          - hiding (Ribosome.Prelude)
          - (Ribosome.Prelude as Prelude)
      - aeson
      - chiasma
      - containers
      - cornea
      - either
      - exceptions
      - hedgehog
      - hslogger
      - lens
      - lifted-base
      - messagepack
      - nvim-hs
      - path
      - prettyprinter
      - prettyprinter-ansi-terminal
      - ribosome-test
      - streamly
      - tasty
      - template-haskell
      - transformers

benchmarks:
  ribosome-bench:
    main: Main.hs
    source-dirs: benchmark
    dependencies:
      - name: ribosome
        mixin:
          - hiding (Ribosome.Prelude)
          - (Ribosome.Prelude as Prelude)
      - aeson
      - chiasma
      - containers
      - cornea
      - criterion
      - either
      - exceptions
      - hedgehog
      - hslogger
      - lens
      - lifted-base
      - messagepack
      - nvim-hs
      - path
      - prettyprinter
      - prettyprinter-ansi-terminal
      - ribosome-test
      - streamly
      - tasty
      - template-haskell
      - transformers
